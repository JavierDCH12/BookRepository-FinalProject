<div class="profile-container">
  <div class="profile-card">

    <!--  Cabecera con foto de perfil -->
    <div class="profile-header">
      <img
        *ngIf="userProfile?.profile_picture"
        [src]="userProfile?.profile_picture + '?t=' + timestamp"
        alt="Foto de perfil actualizada"
        class="profile-picture"
      />

      <!-- 
      // ğŸ”§ Comentado temporalmente: opciÃ³n de cambiar la foto de perfil
      <label *ngIf="editMode" for="fileInput" class="upload-label">ğŸ“‚ Cambiar foto</label>
      <input type="file" id="fileInput" (change)="onFileSelected($event)" hidden>
      -->
    </div>

    <div class="mode-switch">
      <button (click)="activateEditMode()" [disabled]="editMode">âœï¸ Editar Perfil</button>
      <button (click)="activateStatsMode()" [disabled]="showStats">ğŸ“Š Ver EstadÃ­sticas</button>
      <button (click)="navigateToHome()">ğŸ  Inicio</button>
    </div>

    <div *ngIf="editMode" class="edit-section">
      <div class="profile-info">
        <input class="input-edit" [(ngModel)]="editedProfile.username" placeholder="Username">
        <input class="input-edit" [(ngModel)]="editedProfile.email" placeholder="Email">
      </div>

      <div class="profile-details">
        <div class="detail-item">
          <span class="label">ğŸ“ Nombre:</span>
          <input class="input-edit" [(ngModel)]="editedProfile.first_name" placeholder="Nombre">
        </div>

        <div class="detail-item">
          <span class="label">ğŸ“ Apellidos:</span>
          <input class="input-edit" [(ngModel)]="editedProfile.last_name" placeholder="Apellidos">
        </div>

        <div class="detail-item">
          <span class="label">ğŸ”‘ Nueva contraseÃ±a:</span>
          <input class="input-edit" type="password" [(ngModel)]="editedProfile.password" placeholder="ContraseÃ±a">
        </div>
      </div>

      <div class="profile-actions">
        <button class="save-btn" (click)="saveProfileChanges()">ğŸ’¾ Guardar Cambios</button>
        <button class="cancel-btn" (click)="cancelEdit()">âŒ Cancelar</button>
      </div>
    </div>

    <div *ngIf="showStats" class="stats-section">
      <h3>ğŸ“ˆ Tus estadÃ­sticas</h3>
      <div class="stat-item">
        <span class="stat-label">â­ Libros favoritos:</span>
        <span class="stat-value">{{ favoriteCount || 'â€”' }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">ğŸ’– Wishlist:</span>
        <span class="stat-value">{{ wishlistCount || 'â€”' }}</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">ğŸ“Š ValoraciÃ³n media:</span>
        <span class="stat-value">{{ averageRating || 'â€”' }}/5</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">ğŸ“… Miembro desde:</span>
        <span class="stat-value">{{ userProfile?.date_joined | date: 'dd/MM/yyyy' }}</span>
      </div>

      <div *ngIf="!favoriteCount && !wishlistCount" class="no-stats">
        <p>ğŸ“­ AÃºn no tienes estadÃ­sticas. Â¡AÃ±ade libros a tus favoritos o wishlist!</p>
      </div>
    </div>

  </div>
</div>
