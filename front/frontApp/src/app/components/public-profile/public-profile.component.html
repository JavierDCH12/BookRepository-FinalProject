<div class="public-profile-container">

  <div class="loading-container" *ngIf="isLoading">
    <p-progressSpinner styleClass="custom-spinner" strokeWidth="4" animationDuration=".8s"></p-progressSpinner>
    <p>â³ Cargando perfil...</p>
  </div>

  <div class="error-container" *ngIf="!isLoading && errorMessage">
    <p>âš ï¸ {{ errorMessage }}</p>
    <button class="back-home-button" (click)="navigateToHome()">ğŸ  Volver al inicio</button>
  </div>

  <section *ngIf="!isLoading && userProfile" class="profile-content">

    <div class="profile-header">
      <img 
        class="profile-picture"
        [src]="userProfile.profile_picture"
        [alt]="userProfile.username + ' avatar'"
        title="{{ userProfile.username }}'s profile picture"
      />
    
      <div class="user-info">
        <h2>ğŸ‘¤ {{ userProfile.username }}</h2>
        <p>ğŸ“§ {{ userProfile.email }}</p>
        <p>ğŸ“… Se uniÃ³ el {{ userProfile.register_date | date: 'longDate' }}</p>
      </div>
    </div>
    

    <section class="favorites-section">
      <h3>ğŸ“š Libros favoritos</h3>

      <div *ngIf="userProfile.favorites.length === 0" class="no-favorites">
        <p>âœ¨ Este usuario aÃºn no ha aÃ±adido libros a favoritos.</p>
      </div>

      <div class="favorites-grid" *ngIf="userProfile.favorites.length > 0">
        <div
          class="book-card"
          *ngFor="let book of userProfile.favorites; let i = index"
          [ngStyle]="{ 'animation-delay': (i * 100) + 'ms' }"
        >
          <img 
            class="book-cover" 
            [src]="book.cover_url || 'assets/default-cover.png'" 
            [alt]="book.title + ' cover'"
            title="{{ book.title }} cover"
          />
          <div class="book-info">
            <h4>{{ book.title }}</h4>
            <p *ngIf="book.author" class="author">âœï¸ {{ book.author }}</p>

            <div class="rating-display" *ngIf="book.rating && book.rating > 0">
              <ng-container *ngFor="let star of [1,2,3,4,5]">
                <span [class.filled-star]="star <= book.rating">â˜…</span>
              </ng-container>
            </div>

            <blockquote class="review" *ngIf="book.review">
              â€œ{{ book.review }}â€
            </blockquote>
          </div>
        </div>
      </div>
    </section>

    <div class="back-button-container">
      <button class="back-home-button" (click)="navigateToHome()">ğŸ  Volver al inicio</button>
    </div>
  </section>
</div>
