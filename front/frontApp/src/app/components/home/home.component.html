<body>
  <div class="home-container">
    <!-- âœ… AÃ±adido ngClass para centrar si NO estÃ¡ autenticado -->
    <div class="top-layout" [ngClass]="{ 'centered': !isAuthenticated }">
      
      <!-- ğŸ‘¤ Tarjeta de perfil (solo si autenticado) -->
      <div class="profile-card" *ngIf="isAuthenticated">
        <!-- 
        <img 
          alt="profile picture"
          *ngIf="userProfile"
          class="profile-picture"
          [src]="userProfile.profile_picture + '?t=' + timestamp"
          [alt]="userProfile.username + ' avatar'"
          [title]="userProfile.username + '\'s profile picture'"
        />
        -->
        <h3>{{ username }}</h3>
        <p class="user-email">ğŸ“§ {{ userProfile?.email }}</p>
        <button class="profile-button" (click)="navigateToProfile()">
          ğŸ‘¤ Ver Perfil Privado
        </button>
      </div>

      <!-- ğŸ¯ SecciÃ³n principal visible siempre -->
      <div class="main-section">
        <h2>ğŸ“š Bienvenido a BookFinder</h2>
        <p *ngIf="!isAuthenticated">
          Encuentra tus libros favoritos y regÃ­strate para guardar favoritos.
        </p>
        <p *ngIf="isAuthenticated">
          Hola, {{ username }} ğŸ‘‹ Â¡Explora y guarda tus libros preferidos!
        </p>

        <div class="buttons">
          <button *ngIf="!isAuthenticated" (click)="navigateToLogin()" class="modern-button">
            ğŸ”‘ Login
          </button>
          <button *ngIf="!isAuthenticated" (click)="navigateToRegister()" class="modern-button">
            ğŸ“ Registro
          </button>

          <button *ngIf="isAuthenticated" (click)="setView('favorites')" class="modern-button" title="NÃºmero de libros en tus favoritos">
            â­ Mis Favoritos
            <span class="favorite-counter">{{ favoriteCount }}</span>
          </button>
          <button *ngIf="isAuthenticated" (click)="setView('wishlist')" class="modern-button" title="NÃºmero de libros en tu wishlist">
            ğŸ’– Mi Wishlist
            <span class="wishlist-counter">{{ wishlistCount }}</span>
          </button>
          <button *ngIf="isAuthenticated" (click)="setView('search')" [disabled]="currentView === 'search'" class="modern-button">
            ğŸ” Buscar Libros
          </button>
          <button *ngIf="isAuthenticated" (click)="logout()" class="modern-button logout-button">
            ğŸšª Cerrar SesiÃ³n
          </button>
        </div>
      </div>
    </div>

    <!-- ğŸ” Buscador pÃºblico -->
    <div class="search-container" *ngIf="isAuthenticated">
      <div class="public-profile-search-sidebar">
        <h4>ğŸ” Ver perfil pÃºblico</h4>
        <div class="search-bar">
          <input type="text" [(ngModel)]="searchedUsername" placeholder="Introduce un username" (keyup.enter)="navigateToPublicProfile()" />
          <button (click)="navigateToPublicProfile()">Ir</button>
        </div>
        <p class="search-hint">Explora los favoritos de otros usuarios.</p>
      </div>
    </div>

    <!-- ğŸ“˜ Contenido dinÃ¡mico -->
    <div class="dynamic-content-container">
      <app-book-search *ngIf="!isAuthenticated || currentView === 'search'"></app-book-search>
      <app-favorite-list *ngIf="isAuthenticated && currentView === 'favorites'"></app-favorite-list>
      <app-wishlist *ngIf="isAuthenticated && currentView === 'wishlist'"></app-wishlist>
    </div>
  </div>

  <!-- ğŸ“ Footer -->
  <footer class="footer">
    <div class="footer-content">
      <p>ğŸ“– <strong>BookFinder</strong> Â© 2024. Todos los derechos reservados.</p>
      <nav class="footer-nav">
        <a href="https://github.com/JavierDCH12/BookRepository-FinalProject" target="_blank" rel="noopener noreferrer">Repositorio del proyecto</a> |
        <a href="https://github.com/JavierDCH12" target="_blank" rel="noopener noreferrer">Contacto</a>
      </nav>
    </div>
  </footer>
</body>
