<div *ngFor="let book of results" class="book-card">
  <div class="book-cover-container">
    <img *ngIf="book.cover_url" [src]="book.cover_url" alt="Portada"
         class="book-cover" (click)="navigateToBookDetail(book.book_key)" />
  </div>

  <div class="book-info">
    <h4 (click)="navigateToBookDetail(book.book_key)" class="clickable-title">
      {{ book.title }}
    </h4>

    <p *ngIf="book.author" class="author">
      ğŸ‘¤
      <a href="#" (click)="
          $event.preventDefault(); getAuthorWikipediaLink(book.author)
        ">
        {{ book.author }}
      </a>
    </p>

    <p *ngIf="book.first_publish_year" class="publish-year">
      ğŸ“… {{ book.first_publish_year }}
    </p>

    <p *ngIf="book.genres" class="genres">
      ğŸ·ï¸ GÃ©nero: {{ formatGenres(book.genres) }}
    </p>

    <!-- â­ BotÃ³n de Favoritos -->
    <button (click)="toggleFavorite(book); $event.stopPropagation()"
            class="fav-toggle-button"
            [class.active]="isFavorite(book.book_key)"
            [attr.aria-label]="isFavorite(book.book_key) ? 'Quitar de favoritos' : 'AÃ±adir a favoritos'"
            [title]="isFavorite(book.book_key) ? 'Quitar de favoritos' : 'AÃ±adir a favoritos'">
      <i class="pi" [ngClass]="isFavorite(book.book_key) ? 'pi-star-fill' : 'pi-star'"></i>
      {{ isFavorite(book.book_key) ? 'Favorito' : 'AÃ±adir a favoritos' }}
    </button>

    <!-- ğŸ’› BotÃ³n de Wishlist -->
    <button class="wishlist-button"
            [class.in-wishlist]="isInWishlist(book.book_key)"
            (click)="toggleWishlist(book); $event.stopPropagation()"
            [attr.aria-label]="isInWishlist(book.book_key) ? 'Quitar de wishlist' : 'AÃ±adir a wishlist'"
            [title]="isInWishlist(book.book_key) ? 'Quitar de wishlist' : 'AÃ±adir a wishlist'">
      <span class="heart-icon">
        {{ isInWishlist(book.book_key) ? 'â¤ï¸' : 'ğŸ¤' }}
      </span>
    </button>
  </div>
</div>
